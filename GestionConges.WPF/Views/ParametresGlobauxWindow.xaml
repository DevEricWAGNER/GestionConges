<Window x:Class="GestionConges.WPF.Views.ParametresGlobauxWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Paramètres Globaux - Administration" 
        Height="900" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource Background}"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize">

    <Border CornerRadius="16" Background="{StaticResource Background}"
            BorderBrush="{StaticResource Gray200}" BorderThickness="1">
        <Grid Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header avec titre -->
            <Grid Grid.Row="0" Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="{StaticResource Primary}" 
                            Width="56" Height="56" 
                            CornerRadius="16" Margin="0,0,20,0">
                        <TextBlock Text="⚙️" FontSize="28" 
                                 Foreground="White"
                                 HorizontalAlignment="Center" 
                                 VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Paramètres Globaux" 
                                 FontSize="32" FontWeight="Bold" 
                                 Foreground="{StaticResource TextPrimary}"/>
                        <TextBlock Text="Configuration avancée de l'application" 
                                 FontSize="16" 
                                 Foreground="{StaticResource TextSecondary}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Bouton fermer -->
                <Button Grid.Column="1" Content="✕" 
                      Width="32" Height="32" 
                      Background="Transparent" 
                      BorderThickness="0" 
                      Foreground="{StaticResource Gray400}"
                      FontSize="16"
                      Click="BtnFermer_Click"/>
            </Grid>

            <!-- TabControl modernisé -->
            <Border Grid.Row="1" Background="{StaticResource Surface}" 
                    BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                    CornerRadius="16">
                <TabControl Background="Transparent" BorderThickness="0">
                    <TabControl.Resources>
                        <!-- Style moderne pour les onglets -->
                        <Style TargetType="TabItem">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Border Name="Border" Background="Transparent" 
                                              BorderBrush="{StaticResource Gray200}" BorderThickness="0,0,0,2"
                                              Padding="20,12" Margin="0,0,4,0">
                                            <ContentPresenter ContentSource="Header" 
                                                            HorizontalAlignment="Center" 
                                                            VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource Primary}"/>
                                                <Setter TargetName="Border" Property="Background" Value="#E3F2FD"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="{StaticResource Gray50}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Resources>

                    <!-- Onglet Calendrier -->
                    <TabItem>
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <Border Background="{StaticResource Warning}" 
                                        Width="24" Height="24" CornerRadius="6" 
                                        Margin="0,0,8,0">
                                    <TextBlock Text="📅" FontSize="12" 
                                             Foreground="White" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="Calendrier et Jours Ouvrés" 
                                         FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>

                        <ScrollViewer Padding="24" VerticalScrollBarVisibility="Auto">
                            <StackPanel>

                                <!-- Section Jours Ouvrés -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24" Margin="0,0,0,24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Secondary}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="🗓️" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Configuration des Jours Ouvrés" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <TextBlock Text="Sélectionnez les jours travaillés dans votre organisation" 
                                                 Margin="0,0,0,16" FontSize="14"
                                                 Foreground="{StaticResource TextSecondary}"/>

                                        <WrapPanel Orientation="Horizontal" Margin="0,0,0,16">
                                            <CheckBox Name="ChkLundi" Margin="0,0,20,10" IsChecked="True">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Primary}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Lundi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkMardi" Margin="0,0,20,10" IsChecked="True">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Primary}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Mardi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkMercredi" Margin="0,0,20,10" IsChecked="True">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Primary}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Mercredi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkJeudi" Margin="0,0,20,10" IsChecked="True">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Primary}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Jeudi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkVendredi" Margin="0,0,20,10" IsChecked="True">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Primary}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Vendredi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkSamedi" Margin="0,0,20,10" IsChecked="False">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Gray400}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Samedi" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                            <CheckBox Name="ChkDimanche" Margin="0,0,20,10" IsChecked="False">
                                                <CheckBox.Content>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="{StaticResource Gray400}" Width="4" Height="16" 
                                                              CornerRadius="2" Margin="0,0,8,0"/>
                                                        <TextBlock Text="Dimanche" FontWeight="Medium"/>
                                                    </StackPanel>
                                                </CheckBox.Content>
                                            </CheckBox>
                                        </WrapPanel>

                                        <Border Background="{StaticResource Gray50}" CornerRadius="8" Padding="12">
                                            <TextBlock Name="TxtJoursOuvresInfo" 
                                                     Text="5 jours ouvrés par semaine sélectionnés" 
                                                     FontSize="12" Foreground="{StaticResource TextMuted}" 
                                                     FontStyle="Italic"/>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <!-- Section Jours Fériés -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24" Margin="0,0,0,24">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,20">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <Border Background="{StaticResource Danger}" 
                                                        Width="32" Height="32" CornerRadius="8" 
                                                        Margin="0,0,12,0">
                                                    <TextBlock Text="🎉" FontSize="16" 
                                                             Foreground="White" HorizontalAlignment="Center" 
                                                             VerticalAlignment="Center"/>
                                                </Border>
                                                <TextBlock Text="Jours Fériés" 
                                                         FontSize="18" FontWeight="SemiBold" 
                                                         Foreground="{StaticResource TextPrimary}"
                                                         VerticalAlignment="Center"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                <ComboBox Name="CmbAnnee" Width="80" Margin="0,0,10,0" 
                                                        SelectionChanged="CmbAnnee_SelectionChanged"/>
                                                <Button Name="BtnChargerFeries" 
                                                      Style="{StaticResource MaterialDesignOutlineButton}"
                                                      Content="🔄 Charger" Padding="12,6"
                                                      Click="BtnChargerFeries_Click"/>
                                            </StackPanel>
                                        </Grid>

                                        <!-- Actions jours fériés -->
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                            <Button Name="BtnAjouterFerie" 
                                                  Style="{StaticResource MaterialDesignRaisedButton}"
                                                  Background="{StaticResource Primary}"
                                                  Content="➕ Ajouter" Padding="12,8" Margin="0,0,10,0" 
                                                  Click="BtnAjouterFerie_Click"/>
                                            <Button Name="BtnSupprimerFerie" 
                                                  Style="{StaticResource MaterialDesignRaisedButton}"
                                                  Background="{StaticResource Danger}"
                                                  Content="🗑️ Supprimer" Padding="12,8" Margin="0,0,10,0" 
                                                  IsEnabled="False" Click="BtnSupprimerFerie_Click"/>
                                            <Button Name="BtnImporterFeries" 
                                                  Style="{StaticResource MaterialDesignRaisedButton}"
                                                  Background="{StaticResource Warning}"
                                                  Content="📥 Importer France" Padding="12,8" 
                                                  Click="BtnImporterFeries_Click"/>
                                        </StackPanel>

                                        <!-- DataGrid moderne pour jours fériés -->
                                        <Border Background="{StaticResource Gray50}" 
                                                BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                                CornerRadius="8">
                                            <DataGrid Name="DgJoursFeries" Height="250" 
                                                    AutoGenerateColumns="False"
                                                    IsReadOnly="True"
                                                    GridLinesVisibility="None"
                                                    HeadersVisibility="Column"
                                                    SelectionMode="Single"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    RowBackground="Transparent"
                                                    AlternatingRowBackground="{StaticResource Gray50}"
                                                    SelectionChanged="DgJoursFeries_SelectionChanged">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="📅 Date" 
                                                                      Binding="{Binding Date, StringFormat='dd/MM/yyyy'}" 
                                                                      Width="100"/>
                                                    <DataGridTextColumn Header="📝 Nom" 
                                                                      Binding="{Binding Nom}" 
                                                                      Width="200"/>
                                                    <DataGridTextColumn Header="🌍 Type" 
                                                                      Binding="{Binding Type}" 
                                                                      Width="120"/>
                                                    <DataGridCheckBoxColumn Header="✅ Actif" 
                                                                          Binding="{Binding Actif}" 
                                                                          Width="60"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <!-- Section Paramètres de Calcul -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Primary}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="🧮" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Paramètres de Calcul" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <CheckBox Name="ChkExclureFeries" 
                                                Content="Exclure les jours fériés du calcul des congés" 
                                                Margin="0,0,0,12" IsChecked="True"/>
                                        <CheckBox Name="ChkExclureWeekends" 
                                                Content="Exclure automatiquement les weekends" 
                                                Margin="0,0,0,12" IsChecked="True"/>
                                        <CheckBox Name="ChkDemiJournees" 
                                                Content="Autoriser les demi-journées de congés" 
                                                Margin="0,0,0,20" IsChecked="True"/>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="Début de l'année de congés :" 
                                                     VerticalAlignment="Center" Margin="0,0,16,0"
                                                     FontWeight="Medium"/>
                                            <ComboBox Grid.Column="1" Name="CmbDebutAnnee" 
                                                    VerticalAlignment="Center">
                                                <ComboBoxItem Content="Janvier" IsSelected="True"/>
                                                <ComboBoxItem Content="Avril"/>
                                                <ComboBoxItem Content="Septembre"/>
                                            </ComboBox>
                                            <TextBlock Grid.Column="2" 
                                                     Text="(Période de référence pour les compteurs)" 
                                                     VerticalAlignment="Center" Margin="16,0,0,0" 
                                                     FontSize="12" Foreground="{StaticResource TextMuted}" 
                                                     FontStyle="Italic"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Onglet Validation -->
                    <TabItem>
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <Border Background="{StaticResource Secondary}" 
                                        Width="24" Height="24" CornerRadius="6" 
                                        Margin="0,0,8,0">
                                    <TextBlock Text="✅" FontSize="12" 
                                             Foreground="White" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="Règles de Validation" 
                                         FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>

                        <ScrollViewer Padding="24" VerticalScrollBarVisibility="Auto">
                            <StackPanel>

                                <!-- Section Délais -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24" Margin="0,0,0,24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Warning}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="⏱️" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Délais de Validation" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Délai maximum pour validation chef de pôle" 
                                                         Margin="0,0,0,8" FontWeight="Medium"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtDelaiValidateur" Width="60" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="10" Text="7"/>
                                                    </Border>
                                                    <TextBlock Text="jours" VerticalAlignment="Center" 
                                                             Margin="12,0,0,0"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="Délai maximum pour validation chef d'équipe" 
                                                         Margin="0,0,0,8" FontWeight="Medium"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtDelaiAdmin" Width="60" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="10" Text="5"/>
                                                    </Border>
                                                    <TextBlock Text="jours" VerticalAlignment="Center" 
                                                             Margin="12,0,0,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>

                                        <CheckBox Name="ChkEscaladeAuto" 
                                                Content="Escalade automatique si pas de réponse dans les délais" 
                                                Margin="0,20,0,0" IsChecked="False"/>
                                    </StackPanel>
                                </Border>

                                <!-- Section Préavis -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24" Margin="0,0,0,24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Danger}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="📢" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Préavis et Anticipation" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <Grid Margin="0,0,0,20">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Préavis minimum pour les congés" 
                                                         Margin="0,0,0,8" FontWeight="Medium"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtPreavisConges" Width="60" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="10" Text="14"/>
                                                    </Border>
                                                    <TextBlock Text="jours" VerticalAlignment="Center" 
                                                             Margin="12,0,0,0"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="Anticipation maximale" 
                                                         Margin="0,0,0,8" FontWeight="Medium"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtAnticipationMax" Width="60" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="10" Text="365"/>
                                                    </Border>
                                                    <TextBlock Text="jours" VerticalAlignment="Center" 
                                                             Margin="12,0,0,0"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>

                                        <CheckBox Name="ChkBloquerPreavis" 
                                                Content="Bloquer les demandes qui ne respectent pas le préavis" 
                                                Margin="0,0,0,12" IsChecked="False"/>
                                        <CheckBox Name="ChkAlertePrevisVacances" 
                                                Content="Alerter si demandes pendant périodes de vacances scolaires" 
                                                IsChecked="True"/>
                                    </StackPanel>
                                </Border>

                                <!-- Section Règles par Type -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                            <Border Background="{StaticResource Primary}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="🏷️" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Règles Spécifiques par Type" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <Border Background="{StaticResource Gray50}" 
                                                BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                                CornerRadius="8" Margin="0,0,0,12">
                                            <DataGrid Name="DgReglesTypes" Height="200" 
                                                    AutoGenerateColumns="False"
                                                    GridLinesVisibility="None"
                                                    HeadersVisibility="Column"
                                                    SelectionMode="Single"
                                                    Background="Transparent"
                                                    BorderThickness="0">
                                                <DataGrid.Columns>
                                                    <DataGridTemplateColumn Header="🎨" Width="40">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Border Width="25" Height="15" 
                                                                      Background="{Binding CouleurHex}" 
                                                                      BorderBrush="Gray" BorderThickness="1"
                                                                      CornerRadius="2"/>
                                                            </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                    </DataGridTemplateColumn>
                                                    <DataGridTextColumn Header="Type" Binding="{Binding Nom}" 
                                                                      Width="120" IsReadOnly="True"/>
                                                    <DataGridTextColumn Header="Max/An" Binding="{Binding MaximumParAn}" 
                                                                      Width="80"/>
                                                    <DataGridTextColumn Header="Max Consécutif" 
                                                                      Binding="{Binding MaximumConsecutif}" Width="100"/>
                                                    <DataGridTextColumn Header="Préavis (j)" 
                                                                      Binding="{Binding PreavisMinimum}" Width="80"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </Border>

                                        <Border Background="#E8F5E8" BorderBrush="{StaticResource Secondary}" 
                                                BorderThickness="2" CornerRadius="8" Padding="12">
                                            <StackPanel Orientation="Horizontal">
                                                <Border Background="{StaticResource Secondary}" 
                                                        Width="16" Height="16" CornerRadius="8" 
                                                        Margin="0,0,8,0">
                                                    <TextBlock Text="💡" FontSize="10" 
                                                             Foreground="White" HorizontalAlignment="Center" 
                                                             VerticalAlignment="Center"/>
                                                </Border>
                                                <TextBlock Text="Double-cliquez sur une ligne pour modifier les règles spécifiques" 
                                                         FontSize="12" FontStyle="Italic" 
                                                         Foreground="#2E7D32"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Onglet Notifications -->
                    <TabItem>
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <Border Background="{StaticResource Warning}" 
                                        Width="24" Height="24" CornerRadius="6" 
                                        Margin="0,0,8,0">
                                    <TextBlock Text="📧" FontSize="12" 
                                             Foreground="White" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="Notifications" 
                                         FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>

                        <ScrollViewer Padding="24" VerticalScrollBarVisibility="Auto">
                            <StackPanel>

                                <!-- Section Configuration SMTP -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24" Margin="0,0,0,24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Primary}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="📬" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Configuration SMTP" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <CheckBox Name="ChkActiverEmails" 
                                                Content="Activer les notifications par email" 
                                                Margin="0,0,0,20" IsChecked="False" 
                                                Checked="ChkActiverEmails_Checked" 
                                                Unchecked="ChkActiverEmails_Unchecked"/>

                                        <Grid Name="PanneauSMTP" IsEnabled="False">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <StackPanel Grid.Row="0" Grid.ColumnSpan="3" Margin="0,0,0,16">
                                                <TextBlock Text="Serveur SMTP" Margin="0,0,0,8" FontWeight="Medium"/>
                                                <Border Background="{StaticResource Surface}" 
                                                        BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                        CornerRadius="8" Padding="2">
                                                    <TextBox Name="TxtServeurSMTP" 
                                                           Background="Transparent" BorderThickness="0"
                                                           Padding="12" Text="smtp.gmail.com"/>
                                                </Border>
                                            </StackPanel>

                                            <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,16">
                                                <TextBlock Text="Port" Margin="0,0,0,8" FontWeight="Medium"/>
                                                <Border Background="{StaticResource Surface}" 
                                                        BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                        CornerRadius="8" Padding="2">
                                                    <TextBox Name="TxtPortSMTP" 
                                                           Background="Transparent" BorderThickness="0"
                                                           Padding="12" Text="587"/>
                                                </Border>
                                            </StackPanel>

                                            <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,16">
                                                <TextBlock Text="Sécurité" Margin="0,0,0,8" FontWeight="Medium"/>
                                                <CheckBox Name="ChkSSL" Content="Utiliser SSL/TLS" 
                                                        IsChecked="True"/>
                                            </StackPanel>

                                            <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,0,16">
                                                <TextBlock Text="Nom d'utilisateur" Margin="0,0,0,8" FontWeight="Medium"/>
                                                <Border Background="{StaticResource Surface}" 
                                                        BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                        CornerRadius="8" Padding="2">
                                                    <TextBox Name="TxtUtilisateurSMTP" 
                                                           Background="Transparent" BorderThickness="0"
                                                           Padding="12"/>
                                                </Border>
                                            </StackPanel>

                                            <StackPanel Grid.Row="2" Grid.Column="2" Margin="0,0,0,16">
                                                <TextBlock Text="Mot de passe" Margin="0,0,0,8" FontWeight="Medium"/>
                                                <Border Background="{StaticResource Surface}" 
                                                        BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                        CornerRadius="8" Padding="2">
                                                    <PasswordBox Name="TxtMotDePasseSMTP" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="12"/>
                                                </Border>
                                            </StackPanel>
                                        </Grid>

                                        <Button Name="BtnTesterEmail" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              Background="{StaticResource Secondary}"
                                              Content="📧 Tester la Configuration" 
                                              Padding="20,12" IsEnabled="False" 
                                              Click="BtnTesterEmail_Click"/>
                                    </StackPanel>
                                </Border>

                                <!-- Section Templates d'Emails -->
                                <Border Background="{StaticResource Surface}" 
                                        BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                        CornerRadius="12" Padding="24">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                            <Border Background="{StaticResource Danger}" 
                                                    Width="32" Height="32" CornerRadius="8" 
                                                    Margin="0,0,12,0">
                                                <TextBlock Text="📝" FontSize="16" 
                                                         Foreground="White" HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Templates d'Emails" 
                                                     FontSize="18" FontWeight="SemiBold" 
                                                     Foreground="{StaticResource TextPrimary}"
                                                     VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="250"/>
                                                <ColumnDefinition Width="20"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Liste des templates -->
                                            <Border Grid.Column="0" Background="{StaticResource Gray50}" 
                                                    BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                                                    CornerRadius="8">
                                                <ListBox Name="LstTemplates" Background="Transparent"
                                                       BorderThickness="0" Padding="8"
                                                       SelectionChanged="LstTemplates_SelectionChanged">
                                                    <ListBoxItem Tag="nouvelle_demande">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Background="{StaticResource Primary}" 
                                                                    Width="20" Height="20" CornerRadius="4" 
                                                                    Margin="0,0,8,0">
                                                                <TextBlock Text="📤" FontSize="10" 
                                                                         Foreground="White" HorizontalAlignment="Center" 
                                                                         VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Nouvelle demande" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                    </ListBoxItem>
                                                    <ListBoxItem Tag="demande_approuvee">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Background="{StaticResource Secondary}" 
                                                                    Width="20" Height="20" CornerRadius="4" 
                                                                    Margin="0,0,8,0">
                                                                <TextBlock Text="✅" FontSize="10" 
                                                                         Foreground="White" HorizontalAlignment="Center" 
                                                                         VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Demande approuvée" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                    </ListBoxItem>
                                                    <ListBoxItem Tag="demande_refusee">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Background="{StaticResource Danger}" 
                                                                    Width="20" Height="20" CornerRadius="4" 
                                                                    Margin="0,0,8,0">
                                                                <TextBlock Text="❌" FontSize="10" 
                                                                         Foreground="White" HorizontalAlignment="Center" 
                                                                         VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Demande refusée" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                    </ListBoxItem>
                                                    <ListBoxItem Tag="rappel_validation">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Border Background="{StaticResource Warning}" 
                                                                    Width="20" Height="20" CornerRadius="4" 
                                                                    Margin="0,0,8,0">
                                                                <TextBlock Text="⏰" FontSize="10" 
                                                                         Foreground="White" HorizontalAlignment="Center" 
                                                                         VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Rappel validation" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                    </ListBoxItem>
                                                </ListBox>
                                            </Border>

                                            <!-- Editeur de template -->
                                            <StackPanel Grid.Column="2">
                                                <StackPanel Margin="0,0,0,16">
                                                    <TextBlock Text="Sujet de l'email" Margin="0,0,0,8" FontWeight="Medium"/>
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtSujetTemplate" 
                                                               Background="Transparent" BorderThickness="0"
                                                               Padding="12"/>
                                                    </Border>
                                                </StackPanel>

                                                <StackPanel Margin="0,0,0,16">
                                                    <TextBlock Text="Corps du message" Margin="0,0,0,8" FontWeight="Medium"/>
                                                    <Border Background="{StaticResource Surface}" 
                                                            BorderBrush="{StaticResource Gray300}" BorderThickness="1"
                                                            CornerRadius="8" Padding="2">
                                                        <TextBox Name="TxtCorpsTemplate" Height="180" 
                                                               Background="Transparent" BorderThickness="0"
                                                               TextWrapping="Wrap" AcceptsReturn="True" 
                                                               VerticalScrollBarVisibility="Auto" Padding="12"/>
                                                    </Border>
                                                </StackPanel>

                                                <!-- Actions template -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                                    <Button Style="{StaticResource MaterialDesignOutlineButton}"
                                                          Content="👁️ Prévisualiser" Padding="12,8" Margin="0,0,8,0"
                                                          Click="BtnPrevisualiser_Click"/>
                                                    <Button Style="{StaticResource MaterialDesignOutlineButton}"
                                                          Content="📧 Test Email" Padding="12,8" Margin="0,0,8,0"
                                                          Click="BtnTesterTemplate_Click"/>
                                                    <Button Style="{StaticResource MaterialDesignOutlineButton}"
                                                          Content="🔄 Reset" Padding="12,8"
                                                          Click="BtnResetTemplate_Click"/>
                                                </StackPanel>

                                                <Border Background="#E8F5E8" BorderBrush="{StaticResource Secondary}" 
                                                        BorderThickness="2" CornerRadius="8" Padding="12">
                                                    <StackPanel>
                                                        <TextBlock Text="Variables disponibles :" FontWeight="SemiBold" 
                                                                 FontSize="12" Foreground="#2E7D32" Margin="0,0,0,4"/>
                                                        <TextBlock FontSize="11" Foreground="#1B5E20" TextWrapping="Wrap">
                                                            <Run Text="• " FontWeight="Bold"/>
                                                            <Run Text=" &#123;NomUtilisateur&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <Run Text=" • "/>
                                                            <Run Text=" &#123;TypeConge&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <Run Text=" • "/>
                                                            <Run Text=" &#123;DateDebut&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <Run Text=" • "/>
                                                            <Run Text=" &#123;DateFin&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <LineBreak/>
                                                            <Run Text="• " FontWeight="Bold"/>
                                                            <Run Text=" &#123;NombreJours&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <Run Text=" • "/>
                                                            <Run Text=" &#123;MotifRefus&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                            <Run Text=" • "/>
                                                            <Run Text=" &#123;NomValidateur&#125;" FontFamily="Consolas" FontWeight="Bold"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                </TabControl>
            </Border>

            <!-- Boutons d'action -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" 
                      Margin="0,32,0,0">
                <Button Name="BtnSauvegarderParametres" 
                      Style="{StaticResource MaterialDesignRaisedButton}"
                      Background="{StaticResource Secondary}"
                      Padding="24,14" Margin="0,0,12,0" 
                      FontSize="14" FontWeight="SemiBold"
                      Click="BtnSauvegarderParametres_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="💾" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Sauvegarder tous les Paramètres"/>
                    </StackPanel>
                </Button>

                <Button Name="BtnResetParametres" 
                      Style="{StaticResource MaterialDesignRaisedButton}"
                      Background="{StaticResource Warning}"
                      Padding="24,14" Margin="0,0,12,0" 
                      FontSize="14" FontWeight="SemiBold"
                      Click="BtnResetParametres_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔄" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Réinitialiser"/>
                    </StackPanel>
                </Button>

                <Button Name="BtnFermer" 
                      Style="{StaticResource MaterialDesignOutlineButton}"
                      Padding="24,14" 
                      FontSize="14" FontWeight="SemiBold"
                      Click="BtnFermer_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🚪" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Fermer"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</Window>