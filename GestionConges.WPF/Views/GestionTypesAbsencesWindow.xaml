<Window x:Class="GestionConges.WPF.Views.GestionTypesAbsencesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Gestion des Types d'Absences - Administration" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="20"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>

        <!-- Titre -->
        <TextBlock Grid.Row="0" Grid.ColumnSpan="3" 
                 Text="🏷️ Gestion des Types d'Absences"
                 FontSize="24" FontWeight="Bold"
                 Margin="0,0,0,20"
                 HorizontalAlignment="Center"/>

        <!-- Liste des types -->
        <Border Grid.Row="1" Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" Background="White">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- En-tête avec actions -->
                <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#DDDDDD" BorderThickness="0,0,0,1" Padding="15">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📋 Types d'Absences" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>
                        <Button Name="BtnNouveauType" Content="➕ Nouveau" 
                              Background="#4CAF50" Foreground="White" BorderThickness="0"
                              Padding="10,5" Margin="20,0,0,0" Click="BtnNouveauType_Click"/>
                        <Button Name="BtnActualiser" Content="🔄" 
                              Background="#2196F3" Foreground="White" BorderThickness="0"
                              Padding="8,5" Margin="10,0,0,0" Click="BtnActualiser_Click"/>
                    </StackPanel>
                </Border>

                <!-- DataGrid des types -->
                <DataGrid Grid.Row="1" Name="DgTypesAbsences" 
                        AutoGenerateColumns="False"
                        IsReadOnly="True"
                        GridLinesVisibility="Horizontal"
                        HeadersVisibility="Column"
                        SelectionMode="Single"
                        SelectionChanged="DgTypesAbsences_SelectionChanged"
                        CanUserReorderColumns="False"
                        CanUserResizeColumns="True">

                    <DataGrid.Columns>
                        <!-- Ordre (pour réorganiser) -->
                        <DataGridTextColumn Header="📊 Ordre" Binding="{Binding OrdreAffichage}" Width="60"/>

                        <!-- Couleur avec aperçu -->
                        <DataGridTemplateColumn Header="🎨 Couleur" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="30" Height="20" Background="{Binding CouleurHex}" 
                                              BorderBrush="Gray" BorderThickness="1" CornerRadius="3"/>
                                        <TextBlock Text="{Binding CouleurHex}" FontSize="10" 
                                                 VerticalAlignment="Center" Margin="5,0,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- Nom -->
                        <DataGridTextColumn Header="🏷️ Nom" Binding="{Binding Nom}" Width="150"/>

                        <!-- Description -->
                        <DataGridTextColumn Header="📝 Description" Binding="{Binding Description}" Width="200"/>

                        <!-- Validation requise -->
                        <DataGridTemplateColumn Header="✅ Validation" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding NecessiteValidation, StringFormat='{}{0}'}" 
                                             HorizontalAlignment="Center">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding NecessiteValidation}" Value="True">
                                                        <Setter Property="Text" Value="✅"/>
                                                        <Setter Property="Foreground" Value="Green"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding NecessiteValidation}" Value="False">
                                                        <Setter Property="Text" Value="❌"/>
                                                        <Setter Property="Foreground" Value="Red"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- Actif -->
                        <DataGridTemplateColumn Header="🔄 Actif" Width="60">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding Actif, Mode=OneWay}" IsEnabled="False" 
                                            HorizontalAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- Utilisations -->
                        <DataGridTextColumn Header="📊 Utilisé" Binding="{Binding NombreUtilisations}" Width="70"/>
                    </DataGrid.Columns>

                    <!-- Style des lignes -->
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Actif}" Value="False">
                                    <Setter Property="Opacity" Value="0.6"/>
                                    <Setter Property="FontStyle" Value="Italic"/>
                                </DataTrigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#E3F2FD"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Boutons d'action sur la liste -->
        <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" 
                  HorizontalAlignment="Left" Margin="0,15,0,0">
            <Button Name="BtnModifier" Content="✏️ Modifier"
                  Background="#FF9800" Foreground="White" BorderThickness="0"
                  Padding="15,8" Margin="0,0,10,0" 
                  IsEnabled="False" Click="BtnModifier_Click"/>
            <Button Name="BtnSupprimer" Content="🗑️ Supprimer"
                  Background="#F44336" Foreground="White" BorderThickness="0"
                  Padding="15,8" Margin="0,0,10,0" 
                  IsEnabled="False" Click="BtnSupprimer_Click"/>
            <Button Name="BtnActiver" Content="🔄 Activer/Désactiver"
                  Background="#2196F3" Foreground="White" BorderThickness="0"
                  Padding="15,8" Margin="0,0,15,0" 
                  IsEnabled="False" Click="BtnActiver_Click"/>

            <!-- Séparateur -->
            <Border Width="2" Background="#CCCCCC" Margin="10,0"/>

            <Button Name="BtnMonter" Content="⬆️ Monter"
                  Background="#9C27B0" Foreground="White" BorderThickness="0"
                  Padding="12,8" Margin="15,0,5,0" 
                  IsEnabled="False" Click="BtnMonter_Click"/>
            <Button Name="BtnDescendre" Content="⬇️ Descendre"
                  Background="#9C27B0" Foreground="White" BorderThickness="0"
                  Padding="12,8" Margin="5,0,0,0" 
                  IsEnabled="False" Click="BtnDescendre_Click"/>
        </StackPanel>

        <!-- Panneau de détail/édition -->
        <Border Grid.Row="1" Grid.Column="2" 
              BorderBrush="#CCCCCC" BorderThickness="1" 
              Background="White" Padding="15">
            <ScrollViewer>
                <StackPanel Name="PanneauDetail">
                    <TextBlock Text="📝 Détails / Édition" FontSize="16" FontWeight="Bold" Margin="0,0,0,20"/>

                    <!-- Nom -->
                    <TextBlock Text="Nom du type :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBox Name="TxtNom" Padding="8" Margin="0,0,0,15" MaxLength="100"/>

                    <!-- Description -->
                    <TextBlock Text="Description :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBox Name="TxtDescription" 
                           Padding="8" Height="60" TextWrapping="Wrap" AcceptsReturn="True"
                           VerticalScrollBarVisibility="Auto" Margin="0,0,0,15" MaxLength="500"/>

                    <!-- Couleur avec palette -->
                    <TextBlock Text="Couleur :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="10"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Aperçu couleur -->
                        <Border Grid.Column="0" Name="BorderApercu" Width="40" Height="30" 
                              BorderBrush="Gray" BorderThickness="1" CornerRadius="4"/>

                        <!-- Code couleur -->
                        <TextBox Grid.Column="2" Name="TxtCouleur" Text="#3498db" 
                               Padding="8" TextChanged="TxtCouleur_TextChanged" MaxLength="7"/>
                    </Grid>

                    <!-- Palette de couleurs prédéfinies -->
                    <TextBlock Text="Couleurs suggérées :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <WrapPanel Name="PaletteCouleurs" Margin="0,0,0,15">
                        <!-- Généré dynamiquement -->
                    </WrapPanel>

                    <!-- Ordre d'affichage -->
                    <TextBlock Text="Ordre d'affichage :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBox Name="TxtOrdre" Padding="8" Margin="0,0,0,15" MaxLength="3"/>

                    <!-- Options -->
                    <CheckBox Name="ChkActif" Content="Type d'absence actif" Margin="0,5,0,10" IsChecked="True"/>
                    <CheckBox Name="ChkValidation" Content="Nécessite une validation hiérarchique" Margin="0,0,0,15" IsChecked="True"/>

                    <!-- Règles avancées (pour plus tard) -->
                    <TextBlock Text="Règles spécifiques :" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <TextBox Name="TxtRegles" 
                           Padding="8" Height="60" TextWrapping="Wrap" AcceptsReturn="True"
                           VerticalScrollBarVisibility="Auto" Margin="0,0,0,20" 
                           MaxLength="1000"/>
                    <TextBlock Text="Ex: Maximum 25 jours par an, Préavis de 2 semaines..." 
                             FontSize="11" Foreground="Gray" FontStyle="Italic" Margin="0,-15,0,15"/>

                    <!-- Boutons de validation -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,20">
                        <Button Name="BtnSauvegarder" Content="💾 Sauvegarder"
                              Background="#4CAF50" Foreground="White" BorderThickness="0"
                              Padding="15,8" Margin="0,0,10,0" 
                              Click="BtnSauvegarder_Click" IsEnabled="False"/>
                        <Button Name="BtnAnnuler" Content="❌ Annuler"
                              Background="#757575" Foreground="White" BorderThickness="0"
                              Padding="15,8" 
                              Click="BtnAnnuler_Click" IsEnabled="False"/>
                    </StackPanel>

                    <!-- Informations supplémentaires -->
                    <Separator Margin="0,10,0,10"/>
                    <TextBlock Name="TxtInfos" Text="Sélectionnez un type pour voir les détails"
                             TextWrapping="Wrap" FontStyle="Italic" Foreground="Gray"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Bouton Fermer -->
        <Button Grid.Row="2" Grid.Column="2" Content="🚪 Fermer"
              Background="#757575" Foreground="White" BorderThickness="0"
              Padding="15,8" HorizontalAlignment="Right"
              Click="BtnFermer_Click"/>
    </Grid>
</Window>