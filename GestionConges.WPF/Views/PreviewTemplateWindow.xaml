<Window x:Class="GestionConges.WPF.Views.PreviewTemplateWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Prévisualisation du Template Email" 
        Height="650" Width="700"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource Background}"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="NoResize">

    <Border CornerRadius="16" Background="{StaticResource Background}"
            BorderBrush="{StaticResource Gray200}" BorderThickness="1">
        <Grid Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header avec icône et titre -->
            <Grid Grid.Row="0" Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="{StaticResource Primary}" 
                            Width="48" Height="48" 
                            CornerRadius="12" Margin="0,0,16,0">
                        <TextBlock Text="📧" FontSize="24" 
                                 Foreground="White"
                                 HorizontalAlignment="Center" 
                                 VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Prévisualisation Email" 
                                 FontSize="24" FontWeight="Bold" 
                                 Foreground="{StaticResource TextPrimary}"/>
                        <TextBlock Text="Aperçu avec des données de test" 
                                 FontSize="14" 
                                 Foreground="{StaticResource TextSecondary}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Bouton fermer -->
                <Button Grid.Column="1" Content="✕" 
                      Width="32" Height="32" 
                      Background="Transparent" 
                      BorderThickness="0" 
                      Foreground="{StaticResource Gray400}"
                      FontSize="16"
                      Click="BtnFermer_Click"/>
            </Grid>

            <!-- Section Sujet -->
            <Border Grid.Row="1" Background="{StaticResource Surface}" 
                    BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                    CornerRadius="12" Padding="20" 
                    Margin="0,0,0,20">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <Border Background="{StaticResource Warning}" 
                                Width="24" Height="24" 
                                CornerRadius="6" Margin="0,0,12,0">
                            <TextBlock Text="📋" FontSize="12" 
                                     Foreground="White"
                                     HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Sujet de l'email" 
                                 FontWeight="SemiBold" FontSize="16"
                                 Foreground="{StaticResource TextPrimary}"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                    <Border Background="{StaticResource Gray50}" 
                            BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                            CornerRadius="8" Padding="16">
                        <TextBlock Name="TxtSujetPreview" 
                                 TextWrapping="Wrap" 
                                 FontWeight="SemiBold"
                                 FontSize="14"
                                 Foreground="{StaticResource TextPrimary}"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Section Corps du message -->
            <Border Grid.Row="2" Background="{StaticResource Surface}" 
                    BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                    CornerRadius="12" Padding="20">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Border Background="{StaticResource Secondary}" 
                                Width="24" Height="24" 
                                CornerRadius="6" Margin="0,0,12,0">
                            <TextBlock Text="💬" FontSize="12" 
                                     Foreground="White"
                                     HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Corps du message" 
                                 FontWeight="SemiBold" FontSize="16"
                                 Foreground="{StaticResource TextPrimary}"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <Border Background="{StaticResource Gray50}" 
                            BorderBrush="{StaticResource Gray200}" BorderThickness="1"
                            CornerRadius="8" Padding="20">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                    MaxHeight="300"
                                    Style="{DynamicResource {x:Static GridView.GridViewScrollViewerStyleKey}}">
                            <TextBlock Name="TxtCorpsPreview" 
                                     TextWrapping="Wrap" 
                                     FontFamily="Segoe UI"
                                     FontSize="13"
                                     LineHeight="20"
                                     Foreground="{StaticResource TextPrimary}"/>
                        </ScrollViewer>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Informations sur les variables -->
            <Border Grid.Row="3" Background="#E8F5E8" 
                    BorderBrush="{StaticResource Secondary}" BorderThickness="2" 
                    CornerRadius="12" Padding="20" 
                    Margin="0,20,0,0">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <Border Background="{StaticResource Secondary}" 
                                Width="24" Height="24" 
                                CornerRadius="12" Margin="0,0,12,0">
                            <TextBlock Text="💡" FontSize="12" 
                                     Foreground="White"
                                     HorizontalAlignment="Center" 
                                     VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Variables remplacées par des valeurs de test" 
                                 FontWeight="SemiBold" FontSize="14"
                                 Foreground="#2E7D32"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;NomUtilisateur&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → Jean Dupont"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;TypeConge&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → Congés Payés"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;DateDebut&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → 25/08/2025"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;DateFin&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → 28/08/2025"/>
                            </TextBlock>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;NombreJours&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → 3"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;NomValidateur&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → Manager Équipe"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;MotifRefus&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → Raison du refus"/>
                            </TextBlock>
                            <TextBlock FontSize="12" Foreground="#1B5E20" Margin="0,2">
                                <Run Text="• " FontWeight="Bold"/><Run Text=" &#123;ListeDemandes&#125;" FontFamily="Consolas" FontWeight="Bold"/><Run Text=" → Liste des demandes"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Boutons d'action -->
            <StackPanel Grid.Row="4" Orientation="Horizontal" 
                      HorizontalAlignment="Center" 
                      Margin="0,24,0,0">
                
                <Button Name="BtnTest" 
                      Style="{StaticResource MaterialDesignOutlineButton}"
                      Padding="20,12" Margin="0,0,12,0" 
                      FontSize="14" FontWeight="SemiBold"
                      Click="BtnTest_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📧" FontSize="14" Margin="0,0,8,0"/>
                        <TextBlock Text="Envoyer un Test"/>
                    </StackPanel>
                </Button>

                <Button Style="{StaticResource MaterialDesignRaisedButton}"
                      Background="{StaticResource Primary}"
                      Padding="20,12" 
                      FontSize="14" FontWeight="SemiBold"
                      Click="BtnFermer_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="✓" FontSize="14" Margin="0,0,8,0"/>
                        <TextBlock Text="Fermer"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</Window>